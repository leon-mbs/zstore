<html>
    <head>
        
             <title> Довідник контрагентів</title>
 
    </head>

    <body>
        <div class="row">
            <div class="col-12   col-xl-10  ">
                <div zippy="customertable">
                    <h2>Довідник контрагентів </h2>
                    <div class="navbar nav  ">
                        <form zippy="leadf" class="form-inline ">
                            <input   zippy="chleads" type="checkbox"> <b>Режим роботи з лідами </b>
                        </form>
                    </div>
                    <div class="navbar nav  ">
                        <form zippy="filter" class="form-inline ">

                            <label for="searchkey">Пошук</label>
                            <input class="form-control mr-sm-2" type="text" zippy="searchkey">
                            {{^leadmode}}
                            <label for="searchtype">Тип</label>
                            <select zippy="searchtype" class="form-control mr-sm-2">
                                <option value="0">Всі активні</option>
                                <option value="1">Покупці</option>
                                <option value="2">Постачальники</option>
                                <option value="5">Холдинги</option>
                                <option value="10">Деактивовані</option>
                            </select>

                            <label for="searchholding">дочірній для</label>
                            <select zippy="searchholding" class="form-control mr-sm-2">
                                <option value="0">Не вказано</option>
                            </select>
                            {{/leadmode}}
                            {{#leadmode}} 
                            <label for="searchleadsource">джерело</label>
                            <select zippy="searchleadsource" class="form-control mr-2">
                                <option value="0">Не вказано</option>
                            </select>    
                            <label for="searchleadstatus">стан</label>
                            <select zippy="searchleadstatus" class="form-control mr-2">
                                <option value="0">Не вказано</option>
                            </select>    
                            {{/leadmode}} 
                            <input class="btn btn-outline-success   " type="submit" value="ОК"  >

                        </form>
                        {{#leadmode}}  

                        <a class="btn btn-outline-success"   zippy="leadsourcesedit"  ><i class="fa fa-cog"> Джерело лідів</i> </a>
                        &nbsp; <a class="btn btn-outline-success    " zippy="leadstatusesedit"  ><i class="fa fa-cog"> Стан лідів</i> </a>
                        {{/leadmode}}            
                    </div>
                    {{#leadmode}}  
                    <div class="mb-4 ml-2">



                        <a zippy="showstat"><i class="fa fa-chart-area"></i> Статистика</a>




                    </div>
                    {{/leadmode}}  
                    <a zippy="addnew" class="btn btn-primary">Додати нового</a>

                    <form zippy="listform">
                        <table class="table table-hover   table-sm mt-2">
                            <tr>
                                <th onclick=" $('.seldel').prop('checked', $('.seldel').prop('checked') == false);"
                                    style="width:30px;cursor:pointer" title="Зняти/виставити прапорець"><i
                                        class="fa fa-check-double"></i></th>

                                <th ><a zippy="sortname">Ім'я</a> </th>
                                <th >Тел.</th>
                                <th >E-Mail</th>
                                {{^leadmode}}        <th  ><a zippy="sortdoc">Док.</a> </th>    {{/leadmode}}
                                {{#leadmode}}     <th><a zippy="sortleadstatus">стан ліда</a> </th>     {{/leadmode}} 
                                <th> </th>
                                <th> </th>
                                <th> </th>


                                <th> </th>
                                <th> </th>
                                <th> </th>

                            </tr>
                            <tr zippy="customerlist">
                                <td><input class="seldel" zippy="seldel"  type="checkbox"></td>

                                <td  class="text-nowrap"><a zippy="customername"></a></td>
                                <td zippy="customerphone" class="text-nowrap"></td>
                                <td zippy="customeremail" class="text-nowrap"></td>
                                {{^leadmode}}    <td class="text-right" > <span zippy="docs" class="badge badge-secondary badge-pill"></span> </td>  {{/leadmode}}
                                {{#leadmode}}  
                                <td zippy="leadstatus">  </td>  
                                {{/leadmode}}    
                                <td   ><i    zippy="hasaction" class="fa fa-gift"></i></td>

                                                     
                                <td><i zippy="customercomment" class="far fa-sticky-note" data-toggle="tooltip" data-placement="left"></i></td>

                                <td><i zippy="hasmsg" class="fa fa-comments" title="Коментарі"></i></td>
                                <td><i zippy="hasfiles" class="fa fa-paperclip" title="Прикріплені файли  "></i></td>
                                <td><i zippy="isplanned" class="fa fa-calendar-alt" title="Заплановані події"></i></td>

                                <td style="white-space:  nowrap"> &nbsp;&nbsp;
                                    <a zippy="edit" title="Редагувати"><i class="fa fa-edit"></i></a>
                                    &nbsp;&nbsp;&nbsp;<a zippy="contentlist" title="Редагувати додаткові дані"><i
                                            class="fa fa-eye"></i></a>

                                </td>

                            </tr>
                            <tr><td><a class="text-danger" zippy="deleteall" title="Видалити (деактивувати)"><i class="fa fa-trash"></i></a></td><td colspan="9"></td></tr>

                        </table>
                        <div zippy="pag"></div>
                    </form>
                </div>


            </div>
        </div>


        <form class="row" zippy="customerdetail" method="post">
            <h4>&nbsp; Редагувати  </h4>
            <div class="w-100"></div>
            <div class="col-12 col-md-4 ">

                <div class="form-group">
                    <label for="editcustomername">Назва</label>
                    <input required="required" class="form-control" zippy="editcustomername"/>
                    {{#leadmode}}  
                    <small>Можна використати контакт як тимчасове ім'я</small>
                    {{/leadmode}}  
                </div>

                <div class="form-group">
                    <label for="editemail">E-Mail</label>
                    <input class="form-control" zippy="editemail"/>
                </div>
                <div class="form-group">
                    <label for="editphone">Телефон</label>
                    <input pattern="[0-9()\+\s]+" class="form-control" zippy="editphone"/>
                </div>
                <div class="form-group">
                    <label for="editviber">Viber</label>
                    <input class="form-control" zippy="editviber"/>
                </div>



                {{#leadmode}} 
                <div class="form-group">
                    <label for="editleadsource">Джерело ліда</label>
                    <select class="form-control" zippy="editleadsource">
                        <option value="0">Не вказано</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editleadstatus">Стан ліда</label>
                    <select class="form-control" zippy="editleadstatus">
                        <option value="0">Не вказано</option>
                    </select>
                </div>
                {{/leadmode}} 

                {{^leadmode}} 
                <div class="form-group">
                    <label for="edittype">Тип</label>
                    <select zippy="edittype" class="form-control">
                        <option value="0">Не вказано</option>
                    </select>
                </div>
                <div class="form-check">
                    <input zippy="editisholding" type="checkbox" class="form-check-input">
                    <label class="form-check-label" for="editisholding">Холдинг</label>
                    <small>Компанія, що об'єднує дочірні компанії. Використовується для консолідованих звітів</small>
                </div>
                <div class="form-group">
                    <label for="editholding">Дочірня для холдинга</label>
                    <select zippy="editholding" class="form-control">
                        <option value="0">Не обрано</option>
                    </select>
                </div>
                {{#shop}}        
                <div class="form-group">
                    <label for="editpassword">Пароль логiна для каталогу</label>
                    <input class="form-control" zippy="editpassword"  type="password"/>
                    <small>Залиште порожнiм, якщо пароль не змiнюється</small>
                </div>
                 <div class="form-group">
                    <label for="editconfirm">Пiдтвердити пароль</label>
                    <input class="form-control" zippy="editconfirm" type="password"/>
                </div>
           
               <div class="form-check">
                    <input zippy="editallowedshop" type="checkbox" class="form-check-input">
                    <label class="form-check-label" for="editallowedshop" for="editallowedshop" data-label="editallowedshop">Дозвiл на перегляд онлайн каталогу</label>
                </div>        
                {{/shop}}        
                <div class="form-check">
                    <input zippy="editnosubs" type="checkbox" class="form-check-input">
                    <label class="form-check-label" for="editnosubs">Не враховувати в пiдписках</label>
                </div>
                <div class="form-check">
                    <input zippy="editdisabled" type="checkbox" class="form-check-input">
                    <label class="form-check-label" for="editdisabled">Більше не використовується</label>
                </div>        
                {{/leadmode}} 

            </div>

            <div class="col-12 col-md-4 ">
                {{^leadmode}}  
                <div class="form-group">
                    <label for="editcity">Країна</label>
                    <input class="form-control" zippy="editcity"/>
                </div>
                <div class="form-group">
                    <label for="editcountry">Місто</label>
                    <input class="form-control" zippy="editcountry"/>
                </div>
                <div class="form-group">
                    <label for="editaddress">Повна адреса</label>
                    <input class="form-control" zippy="editaddress"/>
                </div>

                <div class="form-group">
                    <label for="editedrpou">ЄДРПОУ</label>
                    <input value="0" class="form-control"   zippy="editedrpou">
                </div>

                <div class="form-check">
                    <input zippy="editjurid" type="checkbox" class="form-check-input">
                    <label class="form-check-label" for="editjurid">Юр. особа</label>
                </div>
                
           <div class="form-group  ">
                        <label for="editpricetype">Тип ціни</label>
                        <select class="form-control" zippy="editpricetype">
                         <option value="none">Не обрано</option>
                        </select>
                    </div>         
                
                {{/leadmode}} 
                <div class="form-group">
                    <label for="editcomment">Примітка</label>
                    <textarea style="height:100px" class="form-control" zippy="editcomment"></textarea>
                </div>
            </div>    

            <div class="w-100"></div>
            <div class="col-12 col-md-4 ">
                <div class="form-group">
                    <button zippy="save" type="submit" class="btn btn-primary ">Зберегти</button> &nbsp;&nbsp;
                    <button zippy="cancel" type="button" class="btn btn-outline-secondary">Відмінити</button>

                </div>
            </div>
        </form>


        <a name="contentviewlink"></a>
        <div class="row mt-2" zippy="contentview">
            <div class="col-12 pb-4">
                <a zippy="back"><i class="fa fa-arrow-circle-left"></i> До переліку</a>
                <h4 zippy=concname></h4>

                <table>
                    <tr><td colspan="2">
                            <span  zippy="concreated"></span>
                        </td></tr>
                    <tr><td colspan="2">
                            <span  zippy="conlastdoc"></span> 
                        </td></tr>
                    <tr><td ><span data-label="conphone">Телефон</span></td><td><span zippy="conphone"></span></td></tr>
                    <tr><td ><span data-label="conemail">E-Mail</span></td><td><span zippy="conemail"></span></td></tr>
                </table>

                {{#leadmode}} 

                <form zippy="conlstform" class="form-inline ">
                    <label for="conleadstatus"> Стан</label> 
                    <select zippy="conleadstatus" class="form-control mr-4"></select>
                    &nbsp;&nbsp; <a zippy="convert"> <i class="fa fa-gavel"></i> Конвертувати в контрагента </a>
                </form>




                {{/leadmode}} 

            </div>
            <div class="col-4 col-xl-3 ">
                <div class="card">
                    <div class="card-body">

                        <h5> Розклад подій </h5>
                        <table class="table table-sm">
                            <tr zippy="dw_eventlist">
                                <td><span zippy="eventdate"></span><br>
                                    <b zippy="eventtitle"></b>
                                    <p zippy="eventdesc">
                                    </p>
                                </td>

                                <td valign="top" style="width: 30px;"><a zippy="delevent"><i class="fa fa-trash"></i></a></td>
                            </tr>
                        </table>
                        <div zippy="eventpag"></div>
                        <hr>

                        <form zippy="addeventform">
                            <div class="form-group">
                                <label for="addeventdate">Дата, час</label>

                                <div class="input-group">
                                    <input   class="form-control"   zippy="addeventdate" >
                                    <span class="input-group-text">:</span>
                                    <input   class="form-control"   zippy="addeventtime" >
                                </div>                                

                            </div>
                            <div class="form-group">
                                <label for="addeventtitle">Заголовок, тип події</label>
                                <input required="required" class="form-control" zippy="addeventtitle">
                            </div>
                            <div class="form-group">
                                <label for="addeventdesc">Коментар</label>
                                <textarea class="form-control" zippy="addeventdesc" style=" height:120px;"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="addeventnotify">Нагадати повідомленням за</label>
                                <select class="form-control" zippy="addeventnotify">
                                    <option value="0">Не нагадувати</option>
                                    <option value="1">1 годину</option>
                                    <option value="2">2 години</option>
                                    <option value="4">4 години</option>
                                    <option value="8">8 годин</option>
                                    <option value="16">16 годин</option>
                                    <option value="24">24 години</option>
                             </select>
                            </div>
                            <input class="btn btn-outline-success  " type="submit" value="Додати">
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-4 col-xl-3 ">
                <div class="card">
                    <div class="card-body">
                        <h5> Коментар </h5>
                        <table class="table table-sm">
                            <tr zippy="dw_msglist">
                                <td>
                                    <span><b zippy="msguser"></b> <span zippy="msgdate" class="text-muted float-right"></span></span>

                                    <p zippy="msgdata"></p>
                                </td>
                                <td valign="top" style="width: 30px;"><a zippy="delmsg"><i class="fa fa-trash"></i></a></td>
                            </tr>
                        </table>
                        <hr>
                        <form zippy="addmsgform">
                            <div class="form-group">
                                <label for="addmsg">Коментар</label>
                                <textarea required="required" class="form-control" zippy="addmsg"
                                          style=" height:120px;"></textarea>
                            </div>
                            <input class="btn btn-outline-success  " type="submit" value="Додати">
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-4 col-xl-3 ">
                <div class="card">
                    <div class="card-body">
                        <h5> Прикріплені файли </h5>
                        <table class="table table-sm">
                            <tr zippy="dw_files">
                                <td><a zippy="filename" target="_blank"></a></td>
                                <td style="width: 30px;"><a zippy="delfile"><i class="fa fa-trash"></i></a></td>
                            </tr>
                        </table>
                        <hr>
                        <form zippy="addfileform" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="addfile">Вибрати файл</label>
                                <input type="file" class="form-control" required="required" zippy="addfile">

                            </div>

                            <div class="form-group">
                                <label for="adddescfile">Опис </label>
                                <input class="form-control" zippy="adddescfile">
                            </div>


                            <input class="btn btn-outline-success  " type="submit" value="Додати">

                        </form>
                    </div>
                </div>
            </div>
            <div class="col-4 col-xl-3 ">
                <div class="card">
                    <div class="card-body">
                        <h5> Договори </h5>
                        <table class="table table-sm">
                            <tr zippy="dw_contr">
                                <td><a title="Перейти" zippy="contract"></a></td>
                                <td><span zippy="contract_desc"></span></td>

                            </tr>
                        </table>

                    </div>
                </div>
                <div class="card">
                    <div class="card-body">
                        <h5> Бонуси </h5>
                        <table class="table table-sm">
                            <tr zippy="dw_bonus">
                                <td zippy="b_date"></td>
                                <td zippy="b_doc"></td>
                                <td zippy="b_bonus" class="text-right"></td>

                            </tr>
                            <tr><td></td> <td class="text-right"><b>Всього:</b></td> <td class="text-right"><b zippy="b_total"></b></td>  </tr>
                        </table>

                    </div>
                </div>
            </div>
        </div>


        <form zippy="leadsourcesform">
            <div class="row">
                <div class="col-12  col-md-6 col-xl-4">
                    <h5>Редагування джерел лідів</h5>
                    <small>Джерела лідів, наприклад, 'інстаграм', 'дзвінок'...</small>  <br>
                    <a  zippy="addnewsource">Додати</a>

                    <table class="table table-sm">
                        <tr zippy="leadsourceslist">
                            <td><input style="width:250px;" zippy="leadsourcename"  ></td>
                            <td><a zippy="delsource"> <i class="fa fa-trash"></i></a></td>
                    </table>
                    <input zippy="leadsourcesave"  type="submit"  value="Зберегти" class="btn  btn-info">
                    <a  zippy="leadsourcecancel" class="btn btn-outline-primary ">Скасувати</a>
                </div>
            </div>
        </form>

        <form zippy="leadstatusesform">
            <div class="row">
                <div class="col-12  col-md-6 col-xl-4">
                    <h5>Редагуванняя станів лідів</h5>
                    <small>Стан ліда, наприклад, 'очікує', 'перемовини'...</small>  <br>
                    <a  zippy="addnewstatus">Додати</a>

                    <table class="table table-sm">
                        <tr zippy="leadstatuseslist">
                            <td><input style="width:250px;" zippy="leadstatusname"  ></td>
                            <td><a zippy="delstatus"> <i class="fa fa-trash"></i></a></td>
                    </table>
                    <input zippy="leadstatussave"  type="submit"  value="Зберегти" class="btn  btn-info">
                    <a  zippy="leadstatuscancel" class="btn btn-outline-primary ">Скасувати</a>
                </div>
            </div>
        </form>
        {{#leadmode}}  


        <div    zippy="statpan">

            &nbsp;      <a zippy="closestat"><i class="fa fa-arrow-alt-circle-left"></i> Назад</a>
            <div class="row"   >
                <div   class="col-12  col-md-6  col-xl-4  ">
                    <div class="card">
                        

                            <div style="width:100%" id="statusesg"></div>

                       
                    </div>
                </div>
                <div   class="col-12  col-md-6  col-xl-4  ">
                    <div class="card">
                        

                            <div style="width:100%" id="sourcesg"></div>
                      
                    </div>
                </div>
                <div   class="col-12  col-md-6  col-xl-4  ">
                    <div class="card">
                       

                            <div style="width:100%" id="sourcescustg"></div>
                       
                    </div>
                </div>

            </div>  

        </div>  








     <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart'], 'language': 'uk'});
      google.charts.setOnLoadCallback(drawChart);

      
    var fontcolor='#000' ;
    var bgcolor='#fff' ;
        {{#darkmode}}
            fontcolor='#fff' ;
            bgcolor='#333' ;
        {{/darkmode}}             
        
 
 
      function drawChart() {
 
             
        var rg1data = google.visualization.arrayToDataTable( 
        
          {{{gr1}}}
        
        );

        
        var rg1options = {
          title: 'Стан лідів' ,
          sliceVisibilityThreshold: 0.01,         
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
          chartArea:{
             "top":25,"bottom":5,"left":10 , "right":60
          } ,
                  
          legendTextStyle:{
             "color":fontcolor 
          } ,
                  
        };

  
       //старвнение
        var rg1chart = new google.visualization.PieChart(document.getElementById('statusesg'));

        rg1chart.draw(rg1data, rg1options);
        
       
        var rg2data = google.visualization.arrayToDataTable( 
        
          {{{gr2}}}
        
        );

        
        var rg2options = {
          title: 'Джерела лідів' ,
          sliceVisibilityThreshold: 0.01,         
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
          chartArea:{
             "top":25,"bottom":5,"left":10 , "right":60
          } ,
                  
          legendTextStyle:{
             "color":fontcolor 
          } ,
                  
        };

  
       //старвнение
        var rg2chart = new google.visualization.PieChart(document.getElementById('sourcesg'));

        rg2chart.draw(rg2data, rg2options);
        
  
        var rg3data = google.visualization.arrayToDataTable( 
        
          {{{gr3}}}
        
        );

        
        var rg3options = {
          title: 'Джерела  конвертованих лідів' ,
          sliceVisibilityThreshold: 0.01,         
          backgroundColor: {
            "fill":bgcolor 
          } , 
          titleTextStyle:{
             "color":fontcolor ,"bold":true
          } ,
                   
          chartArea:{
             "top":25,"bottom":5,"left":10 , "right":60
          } ,
                  
          legendTextStyle:{
             "color":fontcolor 
          } ,
                  
        };

  
       //старвнение
        var rg3chart = new google.visualization.PieChart(document.getElementById('sourcescustg'));

        rg3chart.draw(rg3data, rg3options);
        
        
        
        
        
        
        
        
        
        
        
      }                  
        </script> 

        {{/leadmode}}  

        <script>
            function check_deleteall() {

            return confirm("Видалити?")

            }
        </script>


    </body>
</html>
