<html>
 
    <body>
     
            
         <div class="row justify-content-md-center"  >
          
            <div class="col-12 col-md-auto">

                <h3 class="mt-2 mb-3">Оплата замовлення {{onumber}}</h3>
                 <table class="table table-sm">
                    {{#detail}}
                    <tr>
                       <td>{{itemname}}</td>
                       <td class="text-right">{{qty}}</td>
                       <td class="text-right">{{price}}</td>
                       <td class="text-right">{{sum}}</td>
                    </tr>
                    
                   {{/detail}}  
                       <tr>
                       <td colspan="3" class="text-right"><b>До сплати</b></td>
                       <td class="text-right"><b>{{total}}</b></td>
                    </tr>
             </table>
               
                 
                 {{#qr}}         
                 <button class="btn btn-success" type="button" onclick="payqr();">Оплатити через QR код</button>         
                  {{/qr}}         
            </div>
         

        </div>
   
  
        
  {{#qr}} 
  
     <div class="row justify-content-center mt-4"  >
        <div class="col-12 col-md-auto">
               <h5 id="qrerror" style="display:none"   class="text-danger">Не задані параметри  отримувача</h5>
             
               <div id="qrpan" style="display:none">
                <h4  >QR код для  оплати</h4>
               
                <div class="modal-body  ">
                  <div class="mb-2" id="qrimg" >          </div>
                   <a  class="btn btn-info  " id="qrurl" >  Відкрити посилання        </a>

                   <a class="btn btn-success   " href="javascript:void(0)" onclick="copycb()" title="Скопіювати в кліпборд" >Скопіювати </a>

                </div>        
             </div>        
        
        
        </div>
    </div>
       
 
   <script type="text/javascript">
   
      
       let payqr = function () {
               
          callPageMethod('dataQR',null, null,(data)=> 
          {
             
                 data =  JSON.parse(data) 
                
                 if(data.qrerror== false) {
                    $("#qrpan").show();                     
                    url = data.url
                    $("#qrimg").html(data.img);  
                    $("#qrurl").attr('href',url);  
                 }  else {
                    $("#qrerror").show();    
                 }
                 
                 
                
              
          }); 
         
                 
        }  
    
        function copycb( ){
               var url=    $("#qrurl").attr('href');  
               
                if(navigator.clipboard){
                    navigator.clipboard.writeText(url);
                }else alert('Ваш браузер не підтримує Clipboard'); 
  
      
                  
               }  
               
               
             
               
  </script>  
  {{/qr}} 
 
          
    </body>
</html>
        
 